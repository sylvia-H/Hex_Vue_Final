"use strict";(self["webpackChunkhealthy_diet"]=self["webpackChunkhealthy_diet"]||[]).push([[520],{367:function(l,e,t){t.d(e,{Z:function(){return m}});var s=t(6252),a=t(6949);const d={class:"loader"},i=(0,s.uE)('<div class="load_base load1"><div class="load_base out_loader"><img src="'+a+'" alt="logo"></div></div><div class="load_base load2"><div class="load_base in_loader in_loader1"></div><div class="load_base in_loader in_loader2"></div><div class="load_base in_loader in_loader3"></div><div class="load_base in_loader in_loader4"></div></div>',2),o=[i];function n(l,e,t,a,i,n){return(0,s.wg)(),(0,s.iD)("div",d,o)}var c={name:"VueLoader"},r=t(3744);const u=(0,r.Z)(c,[["render",n]]);var m=u},7520:function(l,e,t){t.r(e),t.d(e,{default:function(){return pl}});var s=t(6252),a=t(3577);const d={class:"container py-20"},i=(0,s.uE)('<div class="row mb-6"><div class="col-12 col-lg-7"><div class="row g-0 | timeline"><div class="col-3"><div class="timeline-pointer"><h6 class="fw-light mt-5">確認訂單</h6></div></div><div class="col-3"><div class="timeline-pointer"><h6 class="fw-light mt-5">填寫訂購資訊</h6></div></div><div class="col-3"><div class="timeline-pointer"><h6 class="fw-bold mt-5">填寫付款資訊</h6></div></div><div class="col-3"><div class="timeline-pointer-undone"><h6 class="fw-light mt-5">完成訂購</h6></div></div></div></div></div>',1),o={class:"row flex-column flex-md-row"},n={class:"col-12 col-lg-7 | mb-6"},c={class:"table table-hover"},r=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{colspan:"2",scope:"col",class:"fz-5"},"訂單資訊")])],-1),u={class:"align-middle table-secondary"},m=(0,s._)("td",null,[(0,s._)("p",null,"訂單總金額")],-1),_={class:"d-flex justify-content-between"},p={class:"fw-bold"},h={key:0,class:"text-success fw-bold"},v={key:1,class:"text-danger fw-bold"},f={class:"align-middle"},b=(0,s._)("td",null,[(0,s._)("p",null,"訂單編號")],-1),g={class:"align-middle"},x=(0,s._)("td",null,[(0,s._)("p",null,"訂單成立日期")],-1),w={class:"align-middle"},y=(0,s._)("td",null,[(0,s._)("p",null,"訂購品項")],-1),k={class:"table table-hover table-borderless"},D=(0,s._)("thead",null,[(0,s._)("th",null,"品名"),(0,s._)("th",null,"數量"),(0,s._)("th",{class:"text-center"},"品項小計")],-1),z={class:"text-center"},L={class:"align-middle"},C=(0,s._)("td",null,[(0,s._)("p",null,"訂購人資訊")],-1),V={class:"table table-hover table-borderless"},$={class:"align-middle"},W=(0,s._)("td",null,"訂購人",-1),j={class:"align-middle"},O=(0,s._)("td",null,"E-mail",-1),E={class:"align-middle"},S=(0,s._)("td",null,"電話",-1),U={class:"align-middle"},q=(0,s._)("td",null,"地址",-1),K={class:"col-12 offset-lg-1 col-lg-4"},Y=(0,s.uE)('<h5>付款資訊</h5><div class="row"><div class="col-4"><hr></div><div class="col-4 d-flex justify-content-center align-items-center"><div class="fz-3"><span class="text-danger mx-1">*</span> 為必填欄位 </div></div><div class="col-4"><hr></div></div>',2),Z={class:"mb-10"},F={class:"mb-5"},M=(0,s._)("span",{class:"mb-2"},[(0,s.Uk)(" 信用卡帳號 "),(0,s._)("span",{class:"text-danger ms-1"},"*")],-1),T={class:"mb-5"},H=(0,s._)("span",{class:"mb-2"},[(0,s.Uk)(" 有效日期 "),(0,s._)("span",{class:"text-danger ms-1"},"*")],-1),N={class:"mb-5"},P=(0,s._)("span",{class:"mb-2"},[(0,s.Uk)(" 安全碼 "),(0,s._)("span",{class:"text-danger ms-1"},"*")],-1),B={class:"bg-light p-5 mb-5"},I={class:"d-flex align-items-center justify-content-between | mb-6"},R=(0,s._)("p",null,"優惠碼",-1),X={class:"d-flex flex-column"},A={for:"couponData"},G={key:0,class:"text-end text-success mt-2"},J={class:"d-flex justify-content-between | mb-6"},Q=(0,s._)("p",null,"折扣",-1),ll={class:"fw-light"},el={class:"d-flex justify-content-between"},tl=(0,s._)("p",{class:"fz-5"},"總金額",-1),sl={class:"fz-5 fw-bold"},al={class:"row d-flex justify-content-end | my-8 my-md-4"},dl={class:"col-6"},il=(0,s._)("button",{type:"button",class:"btn btn-outline-dark w-100"}," 返回 ",-1),ol={class:"col-6"},nl=["disabled"];function cl(l,e,t,cl,rl,ul){const ml=(0,s.up)("VueLoader"),_l=(0,s.up)("VLoading"),pl=(0,s.up)("VField"),hl=(0,s.up)("ErrorMessage"),vl=(0,s.up)("RouterLink"),fl=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(_l,{active:rl.isLoading,"z-index":1e3},{default:(0,s.w5)((()=>[(0,s.Wm)(ml)])),_:1},8,["active"]),(0,s._)("div",d,[i,(0,s._)("div",o,[(0,s._)("div",n,[(0,s._)("table",c,[r,(0,s._)("tbody",null,[(0,s._)("tr",u,[m,(0,s._)("td",_,[(0,s._)("p",p,(0,a.zw)(rl.order.total)+" 元",1),rl.order.is_paid?((0,s.wg)(),(0,s.iD)("p",h," 已付款 ")):((0,s.wg)(),(0,s.iD)("p",v," 未付款 "))])]),(0,s._)("tr",f,[b,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.order.id),1)])]),(0,s._)("tr",g,[x,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(l.$filters.transferTime(rl.order.create_at)),1)])]),(0,s._)("tr",w,[y,(0,s._)("td",null,[(0,s._)("table",k,[D,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(rl.products,((l,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e,class:"align-middle"},[(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(l.product.title),1)]),(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(l.qty),1)]),(0,s._)("td",z,[(0,s._)("p",null,(0,a.zw)(l.final_total),1)])])))),128))])])])]),(0,s._)("tr",L,[C,(0,s._)("td",null,[(0,s._)("table",V,[(0,s._)("tbody",null,[(0,s._)("tr",$,[W,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.name),1)])]),(0,s._)("tr",j,[O,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.email),1)])]),(0,s._)("tr",E,[S,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.tel),1)])]),(0,s._)("tr",U,[q,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.address),1)])])])])])])])])]),(0,s._)("div",K,[Y,(0,s._)("div",Z,[(0,s.Wm)(fl,{ref:"form",onSubmit:ul.submitPayment},{default:(0,s.w5)((({errors:l})=>[(0,s._)("div",F,[M,(0,s.Wm)(pl,{rules:"required|min:16|max:19",class:"form-control",modelValue:rl.formData.credit,"onUpdate:modelValue":e[0]||(e[0]=l=>rl.formData.credit=l),id:"credit",name:"信用卡帳號",min:"16",max:"19",type:"text",placeholder:"Xxxx-xxxx-xxxx-xxxx"},null,8,["modelValue"]),(0,s.Wm)(hl,{name:"信用卡帳號",class:"d-block text-end invalid-feedback"})]),(0,s._)("div",T,[H,(0,s.Wm)(pl,{rules:"required",class:"form-control",modelValue:rl.formData.validate,"onUpdate:modelValue":e[1]||(e[1]=l=>rl.formData.validate=l),type:"month",id:"fvalidate",name:"有效日期",placeholder:"(MM/YY)"},null,8,["modelValue"]),(0,s.Wm)(hl,{name:"有效日期",class:"d-block text-end invalid-feedback"})]),(0,s._)("div",N,[P,(0,s.Wm)(pl,{rules:"required|min:3|max:4",class:"form-control",modelValue:rl.formData.fCSC,"onUpdate:modelValue":e[2]||(e[2]=l=>rl.formData.fCSC=l),type:"text",id:"fCSC",min:"3",max:"4",name:"安全碼",placeholder:"***"},null,8,["modelValue"]),(0,s.Wm)(hl,{name:"安全碼",class:"d-block text-end invalid-feedback"})]),(0,s._)("div",B,[(0,s._)("div",I,[R,(0,s._)("div",X,[(0,s._)("label",A,[(0,s._)("input",{id:"couponData",name:"couponData",class:"form-control",type:"text",onChange:e[3]||(e[3]=(...l)=>ul.checkCoupon&&ul.checkCoupon(...l)),placeholder:"請輸入折扣優惠碼"},null,32)]),rl.is_couponOK?((0,s.wg)(),(0,s.iD)("span",G," 已套用折扣優惠碼 ")):(0,s.kq)("",!0)])]),(0,s._)("div",J,[Q,(0,s._)("p",ll," NT$ "+(0,a.zw)(rl.order.total)+" 元 ",1)]),(0,s._)("div",el,[tl,(0,s._)("p",sl,"NT$ "+(0,a.zw)(rl.order.total)+" 元",1)])]),(0,s._)("div",al,[(0,s._)("div",dl,[(0,s.Wm)(vl,{to:{name:"checkoutOrder"}},{default:(0,s.w5)((()=>[il])),_:1})]),(0,s._)("div",ol,[(0,s._)("button",{type:"submit",disabled:Object.keys(l).length>0||!rl.formData.credit||!rl.formData.validate||!rl.formData.fCSC,class:"btn btn-danger w-100"}," 送出訂單 ",8,nl)])])])),_:1},8,["onSubmit"])])])])])],64)}var rl=t(367),ul={components:{VueLoader:rl.Z},data(){return{isLoading:!1,order:[],products:[],user:[],formData:{},is_couponOK:0}},inject:["emitter"],methods:{getOrder(l){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/sylviah/order/${l}`).then((l=>{this.order=l.data.order,Object.keys(this.order.products).forEach((l=>{this.products.push(this.order.products[`${l}`])})),this.user=this.order.user,this.isLoading=!1})).catch((()=>{this.isLoading=!1}))},checkCoupon(){this.isLoading=!0;const l=document.getElementById("couponData").value,e={code:l};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/sylviah/coupon",{data:e}).then((()=>{this.is_couponOK=1,this.isLoading=!1})).catch((()=>{this.is_couponOK=0,this.isLoading=!1}))},submitPayment(){this.isLoading=!0;const{id:l}=this.$route.params;this.$http.post(`https://vue3-course-api.hexschool.io/v2/api/sylviah/pay/${l}`).then((()=>{this.$refs.form.resetForm(),this.isLoading=!1,this.emitter.emit("toast-msg",{style:"success",content:"已完成付款流程！"}),this.emitter.emit("get-cart"),this.$router.push({name:"checkoutComplete"})})).catch((()=>{this.isLoading=!1,this.emitter.emit("toast-msg",{style:"error",content:"付款失敗，請再試一次！"})}))}},mounted(){const{id:l}=this.$route.params;this.getOrder(l)}},ml=t(3744);const _l=(0,ml.Z)(ul,[["render",cl]]);var pl=_l}}]);
//# sourceMappingURL=520.a76e0b4e.js.map